---
title: Sum Over Subsets (Dynamic Programming)
sidebar_label: Sum Over Subsets (DP)
---

:::note references
1. https://codeforces.com/blog/entry/45223
:::

## Code

``` cpp
#include <iostream>
#include <algorithm>
#include <numeric>

namespace Algorithm {
    // naturally assumes a.size() is a power of 2.
    std::vector<int> sum_over_subsets(std::vector<int> a) {
        int n = std::countr_zero(a.size());
        std::vector<int> f(a.begin(), a.end());
        for (int i = 0; i < n; ++i)
            for (int mask = 0; mask < (1 << n); ++mask)
                if (mask & (1 << i))
                    f[mask] += f[mask ^ (1 << i)];
        return f;
    }
}

int main() {
    std::vector<int> a = {3,7,5,6,1,2,2,1};
    std::vector<int> f = Algorithm::sum_over_subsets(a);
    std::ranges::copy(f, std::ostream_iterator<int>(std::cout, " "));
}
```
